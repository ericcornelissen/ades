# cwd
! exec ades .
stdout .github/workflows/workflow.yml
stdout .github/workflows/workflow.yaml
! stderr .

# file: .yml
! exec ades .github/workflows/workflow.yml
cmp stdout yml-stdout.txt
! stderr .

# file: .yaml
! exec ades .github/workflows/workflow.yaml
cmp stdout yaml-stdout.txt
! stderr .


-- .github/workflows/workflow.yml --
name: Example unsafe workflow
on: [push]

jobs:
  example:
    name: Unsafe .yml
    runs-on: ubuntu-latest
    steps:
    - name: Checkout repository
      uses: actions/checkout@v3
    - name: Unsafe run
      run: echo 'Hello from .yml, ${{ inputs.name }}'
-- .github/workflows/workflow.yaml --
name: Example unsafe workflow
on: [push]

jobs:
  example:
    name: Unsafe .yaml
    runs-on: ubuntu-latest
    steps:
    - name: Checkout repository
      uses: actions/checkout@v3
    - name: Unsafe run
      run: echo 'Hello from .yaml, ${{ inputs.name }}'
-- yml-stdout.txt --
Detected 1 violation(s) in '.github/workflows/workflow.yml':
  job 'Unsafe .yml', step 'Unsafe run' has '${{ inputs.name }}', suggestion:
    1. Set `NAME: ${{ inputs.name }}` in the step's `env` map
    2. Replace all occurrences of `${{ inputs.name }}` by `$NAME`
       (make sure to keep the behavior of the script the same)
-- yaml-stdout.txt --
Detected 1 violation(s) in '.github/workflows/workflow.yaml':
  job 'Unsafe .yaml', step 'Unsafe run' has '${{ inputs.name }}', suggestion:
    1. Set `NAME: ${{ inputs.name }}` in the step's `env` map
    2. Replace all occurrences of `${{ inputs.name }}` by `$NAME`
       (make sure to keep the behavior of the script the same)
