! exec ades
cmp stdout stdout.txt
! stderr .


-- .github/workflows/safe.yml --
name: Example safe workflow
on: [push]

jobs:
  example:
    name: Example safe job
    runs-on: ubuntu-latest
    steps:
    - name: Checkout repository
      uses: actions/checkout@v3
    - name: Safe run
      run: echo 'Hello world!'
-- .github/workflows/unsafe.yml --
name: Example unsafe workflow
on: [push]

jobs:
  example:
    name: Example unsafe job
    runs-on: ubuntu-latest
    steps:
    - name: Checkout repository
      uses: actions/checkout@v3
    - name: Unsafe run
      run: echo 'Hello ${{ inputs.name }}'
-- .github/workflows/not-a-workflow.txt --
I'm not a workflow and I shouldn't be analyzed.
-- .github/workflows/also/not-a-workflow.py --
print("Beep boop I'm a helper script")
-- .github/workflows/also.yml/not-a-workflow.foo --
I'm also not a workflow and I shouldn't be analyzed.
-- .github/workflows/also.yaml/not-a-workflow.bar --
I'm definitly not a workflow and I shouldn't be analyzed.
-- stdout.txt --
Detected 1 violation(s) in '.github/workflows/unsafe.yml':
  job 'Example unsafe job', step 'Unsafe run' has '${{ inputs.name }}', suggestion:
    1. Set `NAME: ${{ inputs.name }}` in the step's `env` map
    2. Replace all occurrences of `${{ inputs.name }}` by `$NAME`
       (make sure to keep the behavior of the script the same)
